STAGE: "A"
EPOCHS: 1
GLOBAL_BATCH_SIZE: 60
BACKBONE_FREEZE: true
USE_LORA: false
SEED: 3407

ANNEAL:
  ENABLED: true
  L2_BLOCKS: 4      # decoder blocks 的数量
  FACTOR: 0.9       # annealing 的 power 因子

RESOLUTION:
  PRESET: "Safe"
  SAFE:
    SHORT_EDGE: [512, 512]      # ⭐ 固定 512
    LONG_EDGE_MAX: 512
    CROP_SIZES: [512]           # ⭐ 只用 512
    COLOR_JITTER: true
    FLIP_PROB: 0.5
  PERFPLUS:
    SHORT_EDGE: [512, 512]      # ⭐ 固定 512
    LONG_EDGE_MAX: 512
    CROP_SIZES: [512]           # ⭐ 只用 512
    COLOR_JITTER: true
    FLIP_PROB: 0.5
    AMP: true
    SDPA: true
    FLASH_ATTN: true
    GRADIENT_CHECKPOINT: true
    GRAD_ACCUM: 2
DATA:
  DATASET: coco_panoptic
  ROOT: "/home/host/coco"
  TRAIN_SPLIT: train2017
  VAL_SPLIT: val2017
  TRAIN_RES_MAX: 512
  BATCH_SIZE: 10
  NUM_WORKERS: 8
  PIN_MEMORY: true
  PERSISTENT_WORKERS: true
  CHECK_EMPTY_TARGETS: true
  OPEN_VOCAB_SPLIT: "ovp_val"
SOLVER:
  OPTIM: AdamW
  LR_HEAD: 1.25e-3
  LR_OTHER: 7.5e-4
  WD_HEAD: 0.0
  WD_OTHER: 0.05
  BETAS: [0.9, 0.98]
  CLIP_GRAD: 1.0
  EPOCHS: 1
  WARMUP_RATIO: 0.05
  LR_SCHEDULE: "cosine"
LOSS:
  MATCH:
    LAMBDA_MASK_IOU: 2.0
    LAMBDA_BCE: 1.0
    LAMBDA_CLS: 0.5
  SEG:
    LAMBDA_BCE: 2.0
    LAMBDA_DICE: 1.0
  OV:
    KL_TEXT_WEIGHT: 0.3
    KL_TEMPERATURE: 2.0
    CE_WEIGHT: 1.0
  AUX:
    WEIGHT: 0.3
  DISTILL:
    FEAT_ALIGN: 0.0
    ITC_WEIGHT: 0.0
MODEL:
  BACKBONE:
    NAME: ViT-B-16-SigLIP2-512
    MODEL_ID: "/home/host/siglip2/"
    DROP_PATH: 0.1
    NAFLEX: false
    FREEZE: true
    FP16: true
    LORA:
      ENABLED: false
  HEAD:
    TYPE: EoMT
    NUM_QUERIES: 150
    NUM_BLOCKS: 4
    MASK_PROJ_DIM: 768
    QUERY_INIT: "text+learnable"
    MASKED_ATTN: true
  OPEN_VOCAB:
    ENABLED: true
    TEXT_MODEL_ID: "/home/host/siglip2/"
    MULTILINGUAL: false
    TEMP: 0.07
    CALIBRATION_BIAS: 0.0
    ENERGY_REJECT_THR: -inf
    PER_CLASS_BIAS: "auto"
    SYNONYMS_JSON: null
EVAL:
  INTERVAL_EPOCHS: 1
  MIN_MASK_SCORE: 0.5
  MIN_AREA: 256
  PQ_METRICS: ["PQ_all", "PQ_things", "PQ_stuff"]
TRAINER:
  PRECISION: "16-mixed"
  DEVICES: 6
  NUM_NODES: 1
  ACCELERATOR: "gpu"
  STRATEGY: "ddp_find_unused_parameters_true"
  SYNC_BATCHNORM: true
  LIMIT_VAL_BATCHES: null
  VAL_CHECK_INTERVAL: 1.0
LOGGING:
  WANDB:
    ENABLED: false
    PROJECT: "eomt"
    ENTITY: null
    GROUP: null
    NAME: "stageA_siglip2"
    TAGS: ["stageA", "SigLIP2"]
    MODE: online
    RESUME: never
OUTPUT_DIR: "outputs/coco_eomt_siglip2_stageA"
